#!/usr/bin/env bash
#
set -e # fail on error

CMD_TRANSPARENCY_ON="transparency-on"
CMD_TRANSPARENCY_OFF="transparency-off"

USAGE="
myterminal: Turn on or off the alacritty terminal transparency

Usage: $(echo $0 | grep -o '[^/]*$') <commands>

Options:
  $CMD_TRANSPARENCY_OFF  Turn off terminal transparency
  $CMD_TRANSPARENCY_ON   Turn on terminal transparency
"

export TERMINAL_TRANSPARENCY=0.94

COMMAND=${1:-$USAGE}

if [ -z "$1" ]; then
    echo "$USAGE"
    exit 1
fi

if [ "$COMMAND" = "$CMD_TRANSPARENCY_OFF" ]; then
  echo "Turning off transparency"
  sed -i "s/opacity = $TERMINAL_TRANSPARENCY/opacity = 1/g" ~/.config/alacritty/alacritty.toml
  exit 0
elif [ "$COMMAND" = "$CMD_TRANSPARENCY_ON" ]; then
  echo "Turning on transparency"
  sed -i "s/opacity = 1/opacity = $TERMINAL_TRANSPARENCY/g" ~/.config/alacritty/alacritty.toml
  exit 0
else
  echo "$USAGE"
  exit 1
fi
